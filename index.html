<html>
  <head>
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-entity id="maze" position="-4 1 -10">
        <a-text
          position="0 -1.4 0.4"
          id="devicemotion"
          rotation="-90 0 0"
          value="devicemotion"
          color="black"
        ></a-text>

        <a-text
          position="0 -1.8 0"
          id="devicemotion2"
          rotation="-90 0 0"
          value="devicemotion"
          color="black"
        ></a-text>

        <a-text
          position="0 -2.2 -0.4"
          id="deviceorientation"
          rotation="-90 0 0"
          value="deviceorientation"
          color="black"
        ></a-text>

        <a-text
          id="something"
          position="0 -2.6 -0.8"
          rotation="-90 0 0"
          value="something"
          color="black"
        ></a-text>

        <a-sky
          src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/city.jpg"
          rotation="0 0 0"
          opacity="0.5"
        ></a-sky>
        <a-entity
          id="camera"
          camera
          look-controls
          raycaster="objects: .collidable; far: 0.5;"
          collider-check
          rotation="0 0 0"
          position="0 0 0"
        ></a-entity>

        <!-- <a-entity id="camera" position="0 0 0"> <a-camera></a-camera></a-entity> -->
        <!-- <a-entity id="camera" position="0 0 0">
          <a-camera></a-camera>
        </a-entity> -->
      </a-entity>
    </a-scene>
  </body>
  <script>
    const something = document.body.querySelector("#something");
    const devicemotion = document.body.querySelector("#devicemotion");
    const devicemotion2 = document.body.querySelector("#devicemotion2");
    const deviceorientation = document.body.querySelector("#deviceorientation");
    const camera = document.getElementById("camera");

    const speed = 0.1;
    const handleOrientation = event => {
      console.log("START :", handleOrientation);
      deviceorientation.setAttribute(
        "value",
        `START deviceorientation ${event.alpha} / ${event.beta} / ${event.gamma}`
      );
    };

    const handleMotion = event => {
      console.log("START :", handleMotion);

      something.setAttribute("value", "SET UP! handleMotion");
      devicemotion.setAttribute("value", "SET UP! handleMotion");

      if (camera) {
        let position = camera.getAttribute("position");
        let rotation = camera.getAttribute("rotation");
        devicemotion.setAttribute(
          "value",
          `START position.x ${Math.cos(((rotation.y - 90) * Math.PI) / 180) *
            speed} `
        );
        devicemotion2.setAttribute(
          "value",
          `START position.y ${MMath.sin(((rotation.y - 90) * Math.PI) / 180) *
            speed} `
        );
        // position.x += event.acceleration.x;
        // position.z += event.acceleration.y;

        // position.x += -Math.cos(((rotation.y - 90) * Math.PI) / 180) * speed;
        // position.z += Math.sin(((rotation.y - 90) * Math.PI) / 180) * speed;
        devicemotion.setAttribute(
          "value",
          `START devicemotion1-1 ${event.acceleration.x} / ${event.acceleration.y} / ${event.acceleration.z}`
        );
        devicemotion2.setAttribute(
          "value",
          `START devicemotion2-1 ${event.rotationRate.alpha} / ${event.rotationRate.beta} / ${event.rotationRate.gamma}`
        );
        camera.setAttribute("position", position);
      }
    };

    window.addEventListener("deviceorientation", handleOrientation, true);
    window.addEventListener("devicemotion", handleMotion, true);

    console.log("START3-1 :", something.getAttribute("value"));
    something.setAttribute("value", "SET UP!!!");
    console.log("START1-1 :", devicemotion);
    console.log("START2-1 :", deviceorientation);
    console.log("START3-2 :", something.getAttribute("value"));
  </script>
</html>
