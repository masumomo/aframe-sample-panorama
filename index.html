<html>
  <head>
    <!--
    <script src="//rawgit.com/aframevr/aframe/cf15c15/dist/aframe-master.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v5.0.0/dist/aframe-extras.min.js"></script>
    <script src="//unpkg.com/aframe-text-geometry-component@^0.5.0/dist/aframe-text-geometry-component.min.js"></script>
	  <script src="//rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
	  <script src="//unpkg.com/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
    -->
    <script src="./js/aframe-master-cf15c15.min.js"></script>
    <script src="./js/aframe-extras-5.0.0.min.js"></script>
    <script src="./js/aframe-text-geometry-component-0.5.1.min.js"></script>
    <script src="./js/aframe-environment-component-7528e44.min.js"></script>
    <script src="./js/aframe-particle-system-component-1.1.3.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <a-asset-item id="crate-obj" src="crate.obj"></a-asset-item>
        <a-asset-item id="crate-mtl" src="crate.mtl"></a-asset-item>
      </a-assets>

      <a-entity
        environment="skyType:gradient; horizonColor:#45527a;preset: forest;  grid: none; ground: hills; groundTexture: walkernoise; groundColor:#ffffff; groundColor2:#f5feff; dressing:none;"
      >
      </a-entity>
      <a-entity
        position="0 2.25 -15"
        particle-system="preset: snow; particleCount: 10000; size: 2"
      ></a-entity>
      <!-- Moon -->
      <a-sphere position="15 30 -40"></a-sphere>
      <!-- Tree -->
      <a-entity class="tree-small" position="2.6 1.5 -1.6">
        <a-cone
          color="#416132"
          height="0.8"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.4"
          radius-top="0.001"
          position="0 0 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="0.9"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.5"
          radius-top="0.001"
          position="0 -0.3 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="1"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.6"
          radius-top="0.001"
          position="0 -0.7 0"
          roughness="1"
        ></a-cone>
        <a-cylinder
          color="#8D4126"
          height="0.6"
          radius="0.1"
          segments-height="0"
          segments-radial="0"
          position="0 -1.5 0"
        ></a-cylinder>
      </a-entity>
      <a-entity class="tree-small" position="3.5 1.5 -2">
        <a-cone
          color="#416132"
          height="0.8"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.4"
          radius-top="0.001"
          position="0 0 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="0.9"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.5"
          radius-top="0.001"
          position="0 -0.3 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="1"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.6"
          radius-top="0.001"
          position="0 -0.7 0"
          roughness="1"
        ></a-cone>
        <a-cylinder
          color="#8D4126"
          height="0.6"
          radius="0.1"
          segments-height="0"
          segments-radial="0"
          position="0 -1.5 0"
        ></a-cylinder>
      </a-entity>
      <a-entity class="tree-small" position="-0.5 1.5 -2">
        <a-cone
          color="#416132"
          height="0.8"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.4"
          radius-top="0.001"
          position="0 0 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="0.9"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.5"
          radius-top="0.001"
          position="0 -0.3 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="1"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.6"
          radius-top="0.001"
          position="0 -0.7 0"
          roughness="1"
        ></a-cone>
        <a-cylinder
          color="#8D4126"
          height="0.6"
          radius="0.1"
          segments-height="0"
          segments-radial="0"
          position="0 -1.5 0"
        ></a-cylinder>
      </a-entity>
      <a-entity class="tree-small" position="0.5 1.5 -2">
        <a-cone
          color="#416132"
          height="0.8"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.4"
          radius-top="0.001"
          position="0 0 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="0.9"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.5"
          radius-top="0.001"
          position="0 -0.3 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="1"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.6"
          radius-top="0.001"
          position="0 -0.7 0"
          roughness="1"
        ></a-cone>
        <a-cylinder
          color="#8D4126"
          height="0.6"
          radius="0.1"
          segments-height="0"
          segments-radial="0"
          position="0 -1.5 0"
        ></a-cylinder>
      </a-entity>
      <a-entity class="tree-small" position="0 1.5 -3.5">
        <a-cone
          color="#416132"
          height="0.8"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.4"
          radius-top="0.001"
          position="0 0 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="0.9"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.5"
          radius-top="0.001"
          position="0 -0.3 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="1"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.6"
          radius-top="0.001"
          position="0 -0.7 0"
          roughness="1"
        ></a-cone>
        <a-cylinder
          color="#8D4126"
          height="0.6"
          radius="0.1"
          segments-height="0"
          segments-radial="0"
          position="0 -1.5 0"
        ></a-cylinder>
      </a-entity>
      <a-entity class="tree-small" position="0.5 1.5 -3">
        <a-cone
          color="#416132"
          height="0.8"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.4"
          radius-top="0.001"
          position="0 0 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="0.9"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.5"
          radius-top="0.001"
          position="0 -0.3 -0"
        ></a-cone
        ><a-cone
          color="#416132"
          height="1"
          segments-height="0"
          segments-radial="15"
          radius-bottom="0.6"
          radius-top="0.001"
          position="0 -0.7 0"
          roughness="1"
        ></a-cone>
        <a-cylinder
          color="#8D4126"
          height="0.6"
          radius="0.1"
          segments-height="0"
          segments-radial="0"
          position="0 -1.5 0"
        ></a-cylinder>
      </a-entity>
      <!-- House TODO -->
      <a-entity class="house" position="3 1 -7" rotation="0 110 0">
        <a-box height="4" width="5" depth="4" color="#8D4126"></a-box>

        <a-box
          position="0 3 1"
          height="4.5"
          width="5"
          depth="0.3"
          color="#ffffff"
          rotation="-55 0 0"
        ></a-box>
        <a-box
          position="0 3 -1"
          height="4.5"
          width="5"
          depth="0.3"
          color="#ffffff"
          rotation="55 0 0"
        ></a-box>
      </a-entity>
      <!-- Kanban TODO -->
      <a-entity class="kanban" position="-2.4 1 -2.7" rotation="0 30 10">
        <a-cylinder
          rotation="0 0 90"
          radius="0.1"
          height="1"
          position="0 0.43 0"
          depth="0.1"
          color="#8D4126"
          geometry="segmentsRadial: 0;"
        ></a-cylinder
        ><a-cylinder
          rotation="0 0 90"
          position="0 -0.5 0"
          radius="0.1"
          height="1"
          depth="0.1"
          color="#8D4126"
          geometry="segmentsRadial: 0;"
        ></a-cylinder>
        <a-box
          position="0 -0.04 0"
          height="0.8"
          width="1"
          depth="0.05"
          color="#8D4126"
          map="bricks"
          ><a-text
            position="-0.46 0 0.05"
            id="hello-world"
            rotation="2 0 0"
            value="Hello World"
            font="aileronsemibold"
            width="4"
            color="#ffffff"
          ></a-text
        ></a-box>
        <a-cylinder
          position="-0.6 -0.34 0"
          radius="0.1"
          height="1.7"
          depth="0.1"
          color="#8D4126"
          geometry="segmentsRadial: 0;"
        ></a-cylinder>
        <a-cylinder
          position="0.6 -0.34 0"
          radius="0.1"
          height="1.7"
          depth="0.1"
          color="#8D4126"
          map="bricks"
          geometry="segmentsRadial: 0;"
        ></a-cylinder>
      </a-entity>
      <a-obj-model
        position="6 -8 10"
        src="#crate-obj"
        mtl="#crate-mtl"
        width="200"
      ></a-obj-model>
      <a-text
        position="-10 5 -5"
        id="devicemotionX"
        rotation="0 0 0"
        value="Hello World!"
        color="#1f2b47"
        font="aileronsemibold"
        width="80"
      ></a-text>
      <!-- <a-text
        position="-0.4 0 0"
        id="devicemotionX"
        rotation="-90 0 0"
        value="devicemotionX"
        color="black"
        font="aileronsemibold"
        width="100"
      ></a-text>
      <a-text
        position="-0.4 0 0.4"
        id="devicemotionY"
        rotation="-90 0 0"
        value="devicemotionY"
        color="black"
        font="aileronsemibold"
        width="100"
      ></a-text>
      <a-text
        id="devicemotionZ"
        position="-0.4 0 0.8"
        rotation="-90 0 0"
        value="devicemotionZ"
        color="black"
        font="aileronsemibold"
        width="100"
      ></a-text> -->

      <!-- <a-light type="ambient" color="white"></a-light> -->

      <a-entity movement-controls position="0 0 0" rotation="10 0 0">
        <a-entity camera position="0 1.4 5" look-controls></a-entity>
      </a-entity>
    </a-scene>
  </body>
  <script>
    const something = document.body.querySelector("#something");
    const devicemotionX = document.body.querySelector("#devicemotionX");
    const devicemotionY = document.body.querySelector("#devicemotionY");
    const devicemotionZ = document.body.querySelector("#devicemotionZ");
    // const deviceorientation = document.body.querySelector("#deviceorientation");
    const camera = document.getElementById("camera");
    const elements = document.querySelector("#my-image01-id");
    var scene = document.querySelector("a-scene");

    if (scene.hasLoaded) {
      run();
    } else {
      scene.addEventListener("loaded", run);
    }

    function run() {
      console.log("hello :");
      // anime({
      //   targets: elements,
      //   left: "240px",
      //   backgroundColor: "#FFF",
      //   borderRadius: ["0%", "50%"],
      //   easing: "easeInOutQuad"
      // });
    }

    const speed = 0.001;
    const handleOrientation = event => {
      console.log("START :", handleOrientation);
      // deviceorientation.setAttribute(
      //   "value",
      //   `START deviceorientation ${event.alpha} / ${event.beta} / ${event.gamma}`
      // );
    };

    const handleMotion = event => {
      console.log("START :", handleMotion);

      // something.setAttribute("value", "SET UP! handleMotion");
      // devicemotionX.setAttribute("value", "SET UP! handleMotion");

      if (camera) {
        let position = camera.getAttribute("position");
        let rotation = camera.getAttribute("rotation");
        // devicemotion.setAttribute(
        //   "value",
        `START position.x ${Math.cos(((rotation.y - 90) * Math.PI) / 180) *
          speed} ` //   "value", // devicemotion2.setAttribute( // );
        `START position.y ${MMath.sin(((rotation.y - 90) * Math.PI) / 180) *
          speed} `;
        // );
        // position.x += event.acceleration.x;
        // position.z += event.acceleration.y;

        const x = Math.floor(event.acceleration.x * 10);
        const y = Math.floor(event.acceleration.y * 10);
        const z = Math.floor(event.acceleration.z * 10);
        devicemotionX.setAttribute("value", `START X ${x} `);
        devicemotionY.setAttribute("value", `START Y ${y} `);
        devicemotionZ.setAttribute("value", `START Z ${z}`);
        camera.setAttribute("position", position);
      }
    };

    // setInterval(() => {
    const position = camera.getAttribute("position");
    const rotation = camera.getAttribute("rotation");
    // console.log("rotation :", rotation);
    position.x += -Math.cos(((rotation.y - 90) * Math.PI) / 180) * speed;
    position.z += Math.sin(((rotation.y - 90) * Math.PI) / 180) * speed;
    camera.setAttribute("position", position);
    // devicemotionX.setAttribute("position", position);
    // devicemotionY.setAttribute("position", position);
    // devicemotionZ.setAttribute("position", position);
    // console.log("position :", position);
    // console.log("camera :", camera);
    // }, 50);
    let moving = false;
    // window.addEventListener(
    //   "touchstart",
    //   function() {
    // setInterval(() => {
    // if (moving) return;
    // moving = true;d
    // const position = camera.getAttribute("position");
    // const rotation = camera.getAttribute("rotation");
    // console.log("rotation :", rotation);
    position.x += -Math.cos(((rotation.y - 90) * Math.PI) / 180) * speed;
    position.z += Math.sin(((rotation.y - 90) * Math.PI) / 180) * speed;
    camera.setAttribute("position", position);
    // }, 50);
    // },
    // false
    // );
    //
    // window.addEventListener(
    // "touchend",
    // function() {
    //   moving = false;
    // },
    // false
    // );
    // window.addEventListener("deviceorientation", handleOrientation, true);
    // window.addEventListener("devicemotion", handleMotion, true);
    //とりあえずオブジェクトを作って移動は諦める　ジャンプは可能（リンク）
    //ワンダーランド的な

    //移動できるようにする。
    devicemotionX.setAttribute("value", `START X  `);
    devicemotionY.setAttribute("value", `START Y  `);
    devicemotionZ.setAttribute("value", `START Z `);
    console.log("START1 :", devicemotionX);
    console.log("START2 :", devicemotionY);
    console.log("START3 :", devicemotionZ);
  </script>
</html>
